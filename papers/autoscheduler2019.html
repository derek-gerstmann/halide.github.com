<html>
  <head>
    <title>Learning to Optimize Halide with Tree Search and Random Programs</title>
    <meta HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=UTF-8">
  </head>
  <body>
    <div style="margin-left:auto; margin-right:auto; width:800">
      <center><h2>Learning to Optimize Halide with Tree Search and Random Programs</h2></center>
      
      <center>
        <table style="text-align: center">
          <tr>
            <td>
              &nbsp<a target="_blank" href="https://andrew.adams.pub/">Andrew Adams</a>&nbsp
            </td>
            <td>
              &nbsp<a target="_blank" href="http://github.com/karimama/">Karima Ma</a>&nbsp
            </td>
            <td>
              &nbsp<a target="_blank" href="https://people.csail.mit.edu/lukea/">Luke Anderson</a>&nbsp
            </td>
            <td>
              &nbsp<a target="_blank" href="https://people.csail.mit.edu/baghdadi/">Riyadh Baghdadi</a>&nbsp
            </td>
            <td>
              &nbsp<a target="_blank" href="https://people.csail.mit.edu/tzumao/">Tzu-Mao Li</a>&nbsp
            </td>
            <td>                    
              &nbsp<a target="_blank" href="http://mgharbi.com/">Michaël Gharbi</a>&nbsp
            </td>
          </tr>
          <tr>
            <td>
              Facebook AI Research
            </td>
            <td>
              UC Berkeley
            </td>
            <td>
              MIT CSAIL
            </td>
            <td>
              MIT CSAIL
            </td>
            <td>
              MIT CSAIL
            </td>
            <td>
              Adobe Research
            </td>
          </tr>
        </table>
        <table style="text-align: center">
          <tr>
            <td>                    
              &nbsp<a target="_blank" href="http://bsteiner.info/">Benoit Steiner</a>&nbsp
            </td>
            <td>                    
              &nbsp<a target="_blank" href="http://github.com/steven-johnson/">Steven Johnson</a>&nbsp
            </td>
            <td>                    
              &nbsp<a target="_blank" href="http://graphics.stanford.edu/~kayvonf/">Kayvon Fatahalian</a>&nbsp
            </td>                                                
            <td>
              &nbsp<a target="_blank" href="https://people.csail.mit.edu/fredo/">Frédo Durand</a>&nbsp
            </td>
            <td>
              &nbsp<a target="_blank" href="https://people.eecs.berkeley.edu/~jrk/">Jonathan Ragan-Kelley</a>&nbsp
            </td>
          </tr>
          <tr>
            <td>
              Facebook AI Research
            </td>
            <td>
              Google
            </td>
            <td>
              Stanford University
            </td>
            <td>
              MIT CSAIL
            </td>                                                                                
            <td>
              UC Berkeley
            </td>                                                                
          </tr>
        </table>
      </center>
      <br>
      <div>
        <center><a target="_blank" href="teaser.png"><img src="teaser.png"></a><br></center>
      </div>

      <hr>
      <p>
        <font size=+1><b>Abstract</b></font><br>
      <p>
        We present a new algorithm to automatically schedule Halide programs for high-performance image processing and deep learning. We significantly improve upon the performance of previous methods, which considered a limited subset of schedules. We define a parameterization of possible schedules much larger than prior methods and use a variant of beam search to search over it. The search optimizes runtime predicted by a cost model based on a combination of new derived features and machine learning. We train the cost model by generating and featurizing hundreds of thousands of random programs and schedules. We show that this approach operates effectively with or without autotuning. It produces schedules which are on average almost twice as fast as the existing Halide autoscheduler without autotuning, or more than twice as fast with, and is the first automatic scheduling algorithm to significantly outperform human experts on average.
      </p>
      </p>
      <hr>

      <p>
        <font size=+1><b>Publication</b></font><br>
      <p>
        Andrew Adams, Karima Ma, Luke Anderson, Riyadh Baghdadi, Tzu-Mao Li, Michaël Gharbi,<br> Benoit Steiner, Steven Johnson, Kayvon Fatahalian, Frédo Durand, Jonathan Ragan-Kelley. <br>
          Learning to Optimize Halide with Tree Search and Random Programs<br>
        ACM Transactions on Graphics 38(4) (Proceedings of ACM SIGGRAPH 2019) <br>
        </p>
      <p>
        <a target="_blank" href="halide_autoscheduler_2019.pdf">halide_autoscheduler_2019.pdf</a>
      </p>
      </p>

      <hr>

      <p>
        <font size=+1><b>Code</b></font><br>
      <p>
        The core autoscheduler has been integrated into Halide main here:
        <a target="_blank" href="https://github.com/halide/Halide/tree/main/src/autoschedulers/adams2019"> https://github.com/halide/Halide/tree/main/src/autoschedulers/adams2019 </a>
      </p>
      <p>
        For full details of the experiments and benchmark applications, see this branch in the Halide repository:
        <a target="_blank" href="https://github.com/halide/Halide/tree/standalone_autoscheduler"> https://github.com/halide/Halide/tree/standalone_autoscheduler </a>
      </p>
      </p>

      <hr>    

      <p>
        <font size=+1><b>Acknowledgements</b></font><br>
      <p>
        This work was partially funded by Toyota, as well as the NSF/Intel Partnership on Computer Assisted Programming for Heterogeneous Architectures through grant CCF-1723445.
      </p>
      </p>
      
    </div>

  </body>
</html>
